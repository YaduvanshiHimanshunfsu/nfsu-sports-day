<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>{{ sport }} | NFSU Sports Day</title>

    <!-- CSS -->
    <link rel="stylesheet" href="/static/style.css">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">

    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="result-page">

<!-- =====================================================
     HEADER
====================================================== -->
<header class="result-header">
    <h1>{{ sport }}</h1>
    <a href="/" class="back-btn">‚¨Ö Back to Home</a>
</header>

<!-- =====================================================
     CHART SECTION
====================================================== -->
<section class="chart-section">

    <h2>üìä Participation Overview</h2>

    <!-- üî¥ DATA CONTAINER (READ BY charts.js ONLY) -->
    <div id="chartData"
         data-programme='{{ programme_chart | tojson }}'
         data-semester='{{ semester_chart | tojson }}'>
    </div>

    <!-- PIE CHART -->
    <div class="chart-box">
        <canvas id="programmeChart"></canvas>
    </div>

    <!-- BAR CHART -->
    <div class="chart-box" style="margin-top:40px;">
        <canvas id="semesterChart"></canvas>
    </div>

</section>

<!-- =====================================================
     RESULT TABLES
====================================================== -->

{% if grouped_data|length == 0 %}
    <p class="no-data">‚ùå No data found</p>
{% endif %}

{% for branch, students in grouped_data.items() %}
<section class="result-section">

    <h2>{{ branch }}</h2>

    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>S.No</th>
                    <th>Full Name</th>
                    <th>Semester</th>
                    <th>Gender</th>
                    <th>Programme</th>
                    <th>Phone</th>
                    {% if team %}
                        <th>Team Members</th>
                    {% endif %}
                </tr>
            </thead>

            <tbody>
            {% for row in students %}
                <tr>
                    <td>{{ row.SNO }}</td>
                    <td>{{ row["Full Name"] }}</td>
                    <td>{{ row["Semester"] }}</td>
                    <td>{{ row["Gender"] }}</td>
                    <td>{{ row["Programme / Branch"] }}</td>
                    <td>{{ row["Phone Number"] }}</td>
                    {% if team %}
                        <td>{{ row[team_col] }}</td>
                    {% endif %}
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

</section>
{% endfor %}

<!-- =====================================================
     CHART SCRIPT
====================================================== -->
<script src="/static/charts.js"></script>

</body>
</html>
